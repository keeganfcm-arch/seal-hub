(function () {

  // Remove existing seal if it exists
  const existing = document.getElementById("cursor-seal");
  if (existing) existing.remove();

  const sealImage = "https://img.sanishtech.com/u/0c172360e902f9a814b9488678c8a6fe.jpeg";

  let mouseX = window.innerWidth / 2;
  let mouseY = window.innerHeight / 2;

  document.addEventListener("mousemove", e => {
    mouseX = e.clientX;
    mouseY = e.clientY;
  });

  // Audio setup
  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

  function playSealSound() {
    const oscillator = audioCtx.createOscillator();
    const gainNode = audioCtx.createGain();

    oscillator.type = "sawtooth";
    oscillator.frequency.setValueAtTime(400, audioCtx.currentTime);
    oscillator.frequency.exponentialRampToValueAtTime(150, audioCtx.currentTime + 0.2);

    gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
    gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.2);

    oscillator.connect(gainNode);
    gainNode.connect(audioCtx.destination);

    oscillator.start();
    oscillator.stop(audioCtx.currentTime + 0.2);
  }

  const seal = document.createElement("img");
  seal.id = "cursor-seal";
  seal.src = sealImage;

  seal.style.position = "fixed";
  seal.style.width = "120px";
  seal.style.left = "200px";
  seal.style.top = "200px";
  seal.style.zIndex = "999999999";
  seal.style.cursor = "pointer";
  seal.style.userSelect = "none";

  document.documentElement.appendChild(seal);

  let x = 200;
  let y = 200;
  let fatigue = 1;
  let baseSpeed = 0.03;
  let scale = 1;

  function animate() {
    const dx = mouseX - x;
    const dy = mouseY - y;
    const distance = Math.sqrt(dx * dx + dy * dy);

    if (distance > 60) {
      fatigue -= 0.003;
    } else {
      fatigue += 0.01;
    }

    fatigue = Math.max(0.4, Math.min(1, fatigue));

    const speed = baseSpeed * fatigue;

    x += dx * speed;
    y += dy * speed;

    const angle = Math.atan2(dy, dx) * (180 / Math.PI);

    seal.style.left = x + "px";
    seal.style.top = y + "px";
    seal.style.transform = `rotate(${angle}deg) scale(${scale})`;

    requestAnimationFrame(animate);
  }

  seal.addEventListener("click", () => {
    if (audioCtx.state === "suspended") {
      audioCtx.resume();
    }

    playSealSound();

    scale = 1.3;
    setTimeout(() => scale = 1, 150);
  });

  animate();

})();
